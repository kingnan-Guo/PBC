C51 COMPILER V9.54   HC595                                                                 05/15/2022 00:29:05 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE HC595
OBJECT MODULE PLACED IN .\Objects\HC595.obj
COMPILER INVOKED BY: C:\Program Files\Keil_v5\C51\BIN\C51.EXE HC595.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(
                    -.\Listings\HC595.lst) TABS(2) OBJECT(.\Objects\HC595.obj)

line level    source

   1          /**
   2           * @file HC595.c
   3           * @author your name (you@domain.com)
   4           * @brief 
   5           * @version 0.1
   6           * @date 2022-05-13
   7           * 
   8           * @copyright Copyright (c) 2022
   9           * 
  10           */
  11          
  12          #include "reg51.h"
  13          #include "HC595.h"
  14          
  15          int count = 8;
  16          
  17          void hc_595_init(){
  18   1          HC595_OE = 1;
  19   1          HC595_SH_CP = 0;
  20   1          HC595_ST_CP = 0;
  21   1          HC595_DS = 0;
  22   1          HC595_OE = 0;
  23   1      }
  24          
  25          void hc_595_drive(unsigned char dat){
  26   1          unsigned char i;
  27   1          HC595_SH_CP = 0;
  28   1          HC595_ST_CP = 0;
  29   1          // dat = 1111 1100
  30   1          for (i = 0; i < count; i++)
  31   1          {
  32   2              // 准备数据 房子啊 IO 口上
  33   2              if (dat >= 0x80)
  34   2              {
  35   3                  HC595_DS = 1;
  36   3              } else
  37   2              {
  38   3                  HC595_DS = 0;
  39   3              }
  40   2              //上升沿 数据一位一位的移入到 移位寄存器 
  41   2              HC595_SH_CP = 0;
  42   2              HC595_SH_CP = 1;
  43   2              dat <<= 1;
  44   2          }
  45   1          //上升沿 移位寄存器的数据到存储器
  46   1          HC595_ST_CP = 0;
  47   1          HC595_ST_CP = 1;
  48   1          // 拉低提高点评抗干扰
  49   1          HC595_SH_CP = 0;
  50   1          HC595_ST_CP = 0;
  51   1          HC595_DS= 0;
  52   1      }
  53          
  54          void led_hc_595_drive(unsigned char datH, unsigned char datL){
C51 COMPILER V9.54   HC595                                                                 05/15/2022 00:29:05 PAGE 2   

  55   1          unsigned char i;
  56   1          unsigned char TEMP;
  57   1          TEMP = datH;
  58   1          for (i = 0; i < count; i++)
  59   1          {
  60   2              // 准备数据 房子啊 IO 口上
  61   2              if (TEMP >= 0x80)
  62   2              {
  63   3                  HC595_DS = 1;
  64   3              } else
  65   2              {
  66   3                  HC595_DS = 0;
  67   3              }
  68   2              //上升沿 数据一位一位的移入到 移位寄存器 
  69   2              HC595_SH_CP = 0;
  70   2              HC595_SH_CP = 1;
  71   2              TEMP <<= 1;
  72   2          }
  73   1          TEMP = datL;
  74   1          for (i = 0; i < count; i++)
  75   1          {
  76   2              // 准备数据 房子啊 IO 口上
  77   2              if (TEMP >= 0x80)
  78   2              {
  79   3                  HC595_DS = 1;
  80   3              } else
  81   2              {
  82   3                  HC595_DS = 0;
  83   3              }
  84   2              //上升沿 数据一位一位的移入到 移位寄存器 
  85   2              HC595_SH_CP = 0;
  86   2              HC595_SH_CP = 1;
  87   2              TEMP <<= 1;
  88   2          }
  89   1          //上升沿 移位寄存器的数据到存储器
  90   1          HC595_ST_CP = 0;
  91   1          HC595_ST_CP = 1;
  92   1      
  93   1      }
  94          
  95          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    150    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
