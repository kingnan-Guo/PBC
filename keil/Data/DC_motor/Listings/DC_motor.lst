C51 COMPILER V9.54   DC_MOTOR                                                              01/29/2022 03:02:35 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE DC_MOTOR
OBJECT MODULE PLACED IN .\Objects\DC_motor.obj
COMPILER INVOKED BY: C:\Program Files\Keil_v5\C51\BIN\C51.EXE DC_motor.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRI
                    -NT(.\Listings\DC_motor.lst) TABS(2) OBJECT(.\Objects\DC_motor.obj)

line level    source

   1          #include"reg51.h"
   2          // #include "stdio.h"
   3          // 为了可以 简写 定义 uint 函数
   4          // #include uint unsigned int;
   5          
   6          sbit IN1 = P2^0;
   7          sbit IN2= P2^1;
   8          sbit E = P2^2;
   9          
  10          unsigned int value[] = {2000, 8000};
  11          
  12          
  13          void delay(unsigned int n)
  14          {
  15   1        unsigned int i=0,j=0;
  16   1        for(i=0;i<n;i++)
  17   1        {
  18   2          for(j=0;j<120;j++);
  19   2        }
  20   1      }
  21          
  22          
  23          // 根据 L293D功能表 ，配置电机正转,转速最高192，占空比100%；
  24          void motor(){
  25   1          IN1 = 1;
  26   1          IN2 = 0;
  27   1          E = 1;
  28   1      }
  29          
  30          
  31          void motor50(){
  32   1          IN1 = 1;
  33   1          IN2 = 0;
  34   1          delay(50);
  35   1          IN1 = 1;
  36   1          delay(50);
  37   1          E = 1;
  38   1      }
  39          
  40          void motorTime(){
  41   1          // IN1 = 1;
  42   1          IN2 = 0;
  43   1          E = 1;
  44   1      }
  45          
  46          void initTime(){
  47   1          TMOD = 0x01; //选择 16位模式
  48   1          TH0 = (65536 - 8000) / 256;
  49   1          TL0 = (65536 - 8000) % 256;
  50   1          ET0 = 1; //定时器中断
  51   1          EA = 1; //开启中断
  52   1          TR0 = 1; //开启定时器
  53   1      
  54   1          // ---- 直流电机 ---
C51 COMPILER V9.54   DC_MOTOR                                                              01/29/2022 03:02:35 PAGE 2   

  55   1          // 给 IN0 赋 初值
  56   1          IN1 = 0;
  57   1      
  58   1      
  59   1      }
  60          
  61          // 直流电机 的转速主要参数 是占空比
  62          int main()
  63          {
  64   1          
  65   1          // printf("hellow ye yun");
  66   1      
  67   1      
  68   1          //  -----    占空比位 100% 的 ------
  69   1          // motor(); 
  70   1      
  71   1          // ------- 占空比位 50% 的 ---------
  72   1          // motor50(); 
  73   1      
  74   1          // ----- 定时器 实现占空比------
  75   1          initTime();
  76   1          while (1)
  77   1          {
  78   2              /* code */
  79   2              motorTime(); 
  80   2          }
  81   1          
  82   1      
  83   1      }
  84          
  85          
  86          // 中断服务程序    定时计数器 : 1
  87          void timer_isr() interrupt 1 {
  88   1          TH0 = (65536 - value[IN1]) / 256;
  89   1          TL0 = (65536 - value[IN1]) % 256;
  90   1      
  91   1          // ---- 直流电机 方波 ---
  92   1          // 给 IN0 取反
  93   1          IN1 = ~IN1;
  94   1      
  95   1      
  96   1      }
  97          
  98          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    239    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
